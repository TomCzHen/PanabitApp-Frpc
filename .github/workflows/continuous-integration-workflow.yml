name: CI

on:
  push:
    branches:
      - master

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        arch: ['386']
        frp_version: ['0.27.1']
    steps:
    - uses: actions/checkout@v1
    - name: Fetch frpc release bin file.
      env:
        FRP_RELEASE_FILE_URL: https://github.com/fatedier/frp/releases/download/v${{ matrix.frp_version }}/frp_${{ matrix.frp_version }}_freebsd_${{ matrix.arch }}.tar.gz
        FRPC_BIN_FILE_PATH: frp_${{ matrix.frp_version }}_freebsd_${{ matrix.arch }}/frpc
      run: |
        curl -L $FRP_RELEASE_FILE_URL | tar -xz -C resource/bin $FRPC_BIN_FILE_PATH --strip-components 1
        ls -ll resource/bin
